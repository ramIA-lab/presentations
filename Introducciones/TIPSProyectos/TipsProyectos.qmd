---
title: "Tips para el proyecto/trabajo prÃ¡ctico"
title-slide-attributes:
    data-background-image: imagenes/imagenes_multivariante.png
    data-background-size: contain
    data-background-opacity: "0.25"
    data-background-color: "white"
author: "Dra. Karina Gibert"
format: 
  revealjs:
    incremental: true
    # theme: night
    theme: [night, "../ideai.scss"]
    background-transition: slide
    logo: imagenes/Logo_UPC.svg.png
    css: logo.css
    embed-resources: false # Para generar un fichero html con todo completo sin necesidad de tener varios ficheros con los estilos
    # multiplex: true # Para que puedan ver lo que se esta presentando
    controls-tutorial: true
    scale: 0.9
    chalkboard: true
    transition: slide # Estilo de transiciÃ³n
    transitionSpeed: slow # Velocidad: 'fast', 'normal', 'slow'
editor: visual
---

```{=html}
<!--
## Competencias transversales a evaluar en trabajos prÃ¡cticos {background-color="#d8f1fc"}
-->
```

------------------------------------------------------------------------

## Competencias transversales a evaluar en trabajos prÃ¡cticos

-   OrganizaciÃ³n del equipo de trabajo.

-   PlanificaciÃ³n y gestiÃ³n de incidencias.

-   Razonamiento

-   SÃ­ntesis y claridad en el informe escrito.

-   Habilidades comunicativas (presentaciÃ³n oral)

-   IntegraciÃ³n de conocimientos (anÃ¡lisis comparativo y conclusiones de trabajos prÃ¡cticos)

------------------------------------------------------------------------

## Hacer un plan de trabajo

-   Identificar las tareas principales (incluir informes, etc.)

-   DiseÃ±ar el grÃ¡fico de precedencia entre tareas.

-   ProgramaciÃ³n temporal (considere cuidadosamente las precedencias entre las tareas)

-   Asignar recursos humanos a las tareas (quiÃ©n hace quÃ© y cuÃ¡ndo) (Asegurar la viabilidad, es decir, todos con un esfuerzo equilibrado asignado y sin selecciones de dedicaciÃ³n que puedan colapsar el equipo)

------------------------------------------------------------------------

## Hacer un plan de trabajo

-   Merecerse un margen de tiempo antes de la entrega para incidencias inesperadas.

-   Planea terminar **ANTES**

-   Merecerse tiempo para preparar presentaciones orales tambiÃ©n.

-   Formato del plan de trabajo: â€“ Diagrama Gant + CuadrÃ­cula de asignaciÃ³n + Plan de riesgos

```{=html}
<!--
::: {.fragment .custom .blur}
First item to be unblurred
:::
https://quarto.org/docs/presentations/revealjs/advanced.html
-->
```

------------------------------------------------------------------------

## Diagrama de Gantt

```{r, echo=FALSE}
#| echo: false

library(readr)
library(ganttrify)

crono <- readr::read_csv2("cono.csv", col_types = readr::cols(Final = readr::col_date(format = "%d/%m/%Y"), 
                                                              Inicio = readr::col_date(format = "%d/%m/%Y")))
colnames(crono) <- c("wp", "activity", "start_date", "end_date")
crono$start_date <- lubridate::ymd(crono$start_date)
crono$end_date <- lubridate::ymd(crono$end_date)
```

```{r}
#| echo: true
#| eval: true

pp <- ganttrify(crono,
          by_date = T,
          size_text_relative = 1, 
          mark_quarters = TRUE,
          exact_date = T,
          colour_palette = c("orange2","blue", "red"),
          month_number = F)
```

```{r}
#| output-location: fragment
#| output: asis
#| fig-width: 12
#| fig-height: 4
#| fig-align: center

pp
```

------------------------------------------------------------------------

## CuadrÃ­cula de asignaciÃ³n

```{r}
#| echo: false

library(dplyr)

data <- data.frame(
  Participants = c(paste0("Tarea ", 1:4), "Coordinador"),
  "Miembro 1" = c("x", "", "", "", "X"),
  "Miembro 2" = c("x", "x", "", "", ""),
  "Miembro 3" = c("X", "x", "x", "x", ""),
  "Miembro 4" = c("", "", "X", "x", ""),
  "Miembro 5" = c("", "", "", "", ""),
  "Miembro 6" = c("", "", "", "X", ""))
```

```{r}
#| echo: false

library(knitr)
library(kableExtra)

# ðŸ“Œ Aplicar negrita a las "X"
data_formatted <- data %>%
  mutate(across(-Participants, ~ ifelse(. == "X", cell_spec(., "html", bold = TRUE), .)))

# ðŸ“Œ Generar la tabla con `kableExtra`
kable(data_formatted, format = "html", escape = FALSE, table.attr = "class='styled-table'",        col.names = c("Participantes", paste0("Miembro ", 1:6)))%>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  row_spec(0, bold = TRUE, color = "blue", background = "white") %>%  # Encabezados en azul, fondo blanco
  row_spec(1:nrow(data), color = "blue", background = "white")        # Todo el texto en azul, fondo blanco
```

```{r}
#| echo: false
#| eval: false

library(gt)

# ðŸ“Œ Aplicar negrita solo a las "X" usando HTML
data_formatted <- data %>%
  mutate(across(-Participants, ~ ifelse(. == "X", html("<b>X</b>"), .))) 

# ðŸ“Œ Crear tabla con `gt` optimizada para Reveal.js
data_formatted %>%
  gt() %>%
  tab_header(title = "AsignaciÃ³n de Miembros") %>%
  fmt_html(columns = everything()) %>%  # Renderizar HTML correctamente en Reveal.js
  cols_label(Participants = "Participantes") %>%
  tab_style(
    style = cell_fill(color = "lightblue"),  # Color de fondo para encabezados
    locations = cells_column_labels()
  ) %>%
  tab_options(
    table.font.size = "14px"
  )
```

<br></br>

-   Misma lista de tareas que Gantt.

-   Marcar quiÃ©n participa en cada uno.

-   En negrita la coordinaciÃ³n de tareas.

-   Cada coordinador de tareas es responsable del buen desarrollo de la tarea y se sincroniza con los coordinadores de otras tareas.

------------------------------------------------------------------------

## Plan de Riesgos

![](imagenes/tabla.png){width="800" height="300" fig-align="center"}

-   Enumerar los posibles problemas que pueden aparecer a lo largo del trabajo y pueden hacer que el trabajo final fracase

-   Planificar acciones para prevenir estas situaciones.

-   Indique cÃ³mo gestionarÃ­a la situaciÃ³n si finalmente se presentara.

------------------------------------------------------------------------

## Habilidades

![](imagenes/resumen1.png){width="600" height="400" fig-align="center"}

::: {.callout-note title="De la Cruz et al, Ministerio de educaciÃ³n y deporte"}
La Ãºnica forma de comunicar con claridad es haciendo coincidir los mensajes verbales y no verbales
:::

------------------------------------------------------------------------

## Habilidades

![](imagenes/resumen2.png){width="1000" height="600" fig-align="center"}

------------------------------------------------------------------------

# Buenas prÃ¡cticas de trabajo

------------------------------------------------------------------------

# Proyectos y rutas de archivos

------------------------------------------------------------------------

## Problema: Cada componente del grupo tiene en una ruta diferente su base de datos

```{r}
#| echo: true
#| eval: false

data <- read_csv("C:/Users/username/OneDrive/R code/LOS.csv")
```

O tal vez ...

```{r}
#| echo: true
#| eval: false

setwd("C:/Users/username/OneDrive/R code")
```

-   Una forma fÃ¡cil de hacer esto es usando un proyecto R

    -   Utilice un nuevo proyecto R para cada proyecto de anÃ¡lisis

    -   Haga doble clic en el archivo del proyecto para abrir RStudio con sus archivos en el lugar correcto.

------------------------------------------------------------------------

## Proyectos R

Los proyectos R son un tipo especial de archivo con un . ExtensiÃ³n Rproj que te facilita mantener todos los datos, cÃ³digo e imÃ¡genes de un proyecto en un solo lugar.

Abra RStudio, luego haga clic en **Archivo** -\> **Nuevo proyecto** -\> **Nuevo directorio** - **Nuevo proyecto**.

-   Escriba el nombre que desea darle a su nueva carpeta. Luego, use Explorar para seleccionar en quÃ© lugar de su computadora desea crear la carpeta.

-   Finalmente, clicamos `Crear proyecto`. La nueva carpeta se crearÃ¡ y abrirÃ¡ en RStudio, a veces puede tardar un par de minutos.

------------------------------------------------------------------------

## Carpetas de proyectos

::: {.callout-tip title="Usar proyectos de R"}
Mantenga todo lo relacionado con su anÃ¡lisis junto, y fÃ¡cil de encontrar para R usando proyectos.
:::

<br></br>

::::: columns
::: {.column width="50%"}

```text
R
â”‚   messy_example_script.R
â”‚   R scripts for other project 1.R
â”‚   R scripts for other project 2.R
â”‚   R scripts for other project 3.R

```
:::

::: {.column width="50%"}
         
```text
project folder
â”‚   messy_example_script.R
|   data.csv
|   project_name.Rproj

```
:::
:::::

------------------------------------------------------------------------

# Organizar un *Script*

------------------------------------------------------------------------

## AÃ±adir comentarios

- AÃ±adir comentarios usando la `#` en R (en lineas separadas)

::: fragment
::: {.callout-important title = "*Mala praxis*"}
Los comentarios no necesitan explicar lo que hace tu cÃ³digo.
:::
:::

<br></br>

::: fragment
::: {.callout-tip title = "*Buena praxis*"}
Los comentarios deberÃ­an explicar **POR QUÃ‰** lo hiciste.
:::
:::

------------------------------------------------------------------------

## Secciones y subsecciones

Puedes aÃ±adir secciones y subsecciones al cÃ³digo:

```text
# Load data ---------------------------------------

## Geospatial files -------------------------------

## Population files -------------------------------
```

![](imagenes/grafico_script.png){width="600" height="400" fig-align="center"}

------------------------------------------------------------------------

## EstructuraciÃ³n del *Script*

- Todas las librerias (`library()`) se han de colocar al inicio

- Â¡No se han de agregar los `install.packages()` al script! Se han de ejecutar directamente a la consola

- Se han de dividir en secciones grandes con nombres Ãºtiles

------------------------------------------------------------------------

## Estilos del *Script*

Este cÃ³digo se ejecuta sin errores pero...

```{r}
#| echo: true
#| eval: false

starwars |> filter(height>100) |>select(eye_color, mass)|> group_by(eye_color) |>summarise(mean_mass =mean(mass, na.rm = T))
```

<br></br>

Este es el mismo cÃ³digo:

```{r}
#| echo: true
#| eval: false

starwars |> 
  filter(height > 100) |> 
  select(eye_color, mass) |> 
  group_by(eye_color) |> 
  summarise(mean_mass = mean(mass, na.rm = TRUE))
```

------------------------------------------------------------------------

## *Linting*

**Linting**: AnÃ¡lisis del cÃ³digo fuente para detectar: 

- **cuestiones de estilo**: `x<-3` a `x <- 3`
- **errores comunes**: `mean(x, na.rm = T, na.rm = F)`

- **paquetes faltantes**

- ...

:::: {.columns}
::: {.column width="70%"}
En R, el control del *linting* lo realiza el paquete [`{lintr}`](https://lintr.r-lib.org/)
:::

::: {.column width="30%"}
![](imagenes/lintr_packages.png){fig-align="center"}
:::
::::

-------------------------------------------------

## lintr

Ejecutando el comando: `lintr::lint("file.R")`

![](imagenes/lintr_ejecucion.png){fig-align="center"}


-------------------------------------------------

## Styling

{lintr} es el paquete que permite identificar **el quÃ©** estÃ¡ mal pero no soluciona los problemas. 

<br></br>

:::: {.columns}
::: {.column width="70%"}
El paquete de R [`{styler}`](https://styler.r-lib.org/) le darÃ¡ estilo al cÃ³digo
:::

::: {.column width="30%"}
![](https://styler.r-lib.org/reference/figures/logo.png){width=60% fig-align="left"}
:::
::::

::: {.callout-tip title = "Atajos del teclado"}

Mediante la funciÃ³n `styler::style_active_file()` se activa el cambio de estilo de cÃ³digo

El paquete `{styler}` no soluciona todos los problemas encontrados en `{lintr}`.
::: 

-------------------------------------------------

## Buenas prÃ¡cticas de Google 

:::: {.columns}
::: {.column width="60%"}

Google pone a disposiciÃ³n de los desarrolladores un [cÃ³digo de buenas prÃ¡cticas](https://google.github.io/styleguide/) con todo lo que ha de tener en cuenta un desarrollador para la escritura de cÃ³digo.

:::

::: {.column width="40%"}

![](imagenes/google.png){fig-align="center"}

:::
::::


-------------------------------------------------

# MÃºltiples *scripts* y carpetas

-------------------------------------------------

## Dividir scripts de R

Imagina una estructura de directorio como esta: 

```text
project
â”‚   Rscript.R
```
que contiene todo el cÃ³digo del proyecto. 

Esto estÃ¡ bien pero: 

- No es genial si `RScript.R` contiene 4.000 lÃ­neas

- Las secciones y subsecciones son geniales, pero a veces no son suficientes para separar todo el cÃ³digo

- No es un nombre muy descriptivo

- Es un script que problablemente hace muchas cosas diferentes

-------------------------------------------------

## Dividir scripts de R

![](imagenes/proceso_KDD.png){fig-align="center"}

-------------------------------------------------

## Varios archivos

:::: {.columns}
::: {.column width="50%"}

#### Nombres aceptables 

```text
project
â”‚   data wrangling.R
â”‚   load data.R
â”‚   modelling.R
â”‚   packages.R
â”‚   plots.R
â”‚   plots2.R
```
:::

::: {.column width="50%"}

#### Mejores nombres

```text
project
â”‚   00_packages.R
â”‚   01_load_data.R
â”‚   02_data_wrangling.R
â”‚   03_exploratory_plots.R
â”‚   04_modelling.R
â”‚   05_final_plots_tables.R
```
:::
::::

::: {.callout-tip title = "Atajos del teclado"}

- Prefijo con nÃºmeros para darles un orden (aÃ±adir ceros a la izquierda)

- Dar nombres sensatos y descriptivos

- Evitar los espacios (o `_` o `-`)

::: fragment
Nota: En los nombres de las variables y funciones se aplican el mismo criterio
:::
:::


-------------------------------------------------

## Varias carpetas 

Para una Ã³ptima organizaciÃ³n del proyecto, la estructura de carpetas que se deberÃ­a de realizar es la siguiente: 

```text
project
â”‚   project.Rproj
â”‚   README.md
â””â”€â”€â”€data
â”‚   â”‚   data_inicial.RData
â”‚   â”‚   data_preprocessada.RData
â”‚   â”‚   data_modelling.RData
â””â”€â”€â”€docs
â””â”€â”€â”€inputs
â”‚   â”‚   data.csv
â””â”€â”€â”€outputs
â”‚   â””â”€â”€â”€ data_final.csv 
â”‚   â””â”€â”€â”€ plots
â”‚        â”‚   residuals.png
â”‚        â”‚   outcome_by_age.png
â”‚        â”‚   outcome_by_occupation.png
â””â”€â”€â”€syntax
â”‚   â”‚   00_packages.R
â”‚   â”‚   01_load_data.R
â”‚   â”‚   02_data_wrangling.R
â”‚   â”‚   03_exploratory_plots.R
â”‚   â”‚   04_modelling.R
â”‚   â”‚   05_final_plots_tables.R
â””â”€â”€â”€temp
```

-------------------------------------------------

## Dependencias de los scripts en R


:::: fragment

```text
project
â””â”€â”€â”€syntax
â”‚   â”‚   00_packages.R
â”‚   â”‚   01_load_data.R
â”‚   â”‚   02_data_wrangling.R
â”‚   â”‚   03_exploratory_plots.R
â”‚   â”‚   04_modelling.R
â”‚   â”‚   05_final_plots_tables.R
```

::::

- El scripts 01 depende de 00
- El script 02 depende de 01 (y 00)
- El script 03 depende de 02 (y 01 y 00)
- El script 04 depende de 03 (y 02 y 01 y 00)
- ...

::: fragment
::: {.callout-tip title = "Atajos del teclado"}

Â¡Escribe todo esto (en un archivo README.md)!
:::
:::

-------------------------------------------------

# Otros consejos Ãºtiles

-------------------------------------------------

## Problema: su coautor utiliza una versiÃ³n de paquete diferente

:::: {.columns}
::: {.column width="50%"}
[**renv:**](https://rstudio.github.io/renv/articles/renv.html)

- Aislar el entorno del proyecto
- Fijar versiones especÃ­ficas del paquete R a cada proyecto
- Hace que sea mÃ¡s fÃ¡cil utilizar la misma versiÃ³n que los colaboradores
:::

::: {.column width="50%"}
![](https://rstudio.github.io/renv/logo.svg){width=60% fig-align="center"}
:::
::::

-------------------------------------------------

## Problema: su coautor utiliza una versiÃ³n de diferente de R

:::: {.columns}
::: {.column width="50%"}
[**rig:**](https://github.com/r-lib/rig)

- Administrar mÃºltiples versiones de R
- Cambiar entre diferentes versiones de R para diferentes proyectos
:::

::: {.column width="50%"}
![](https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/R_logo.svg/800px-R_logo.svg.png){width=60% fig-align="center"}
:::
::::

-------------------------------------------------

## Problema: su coautor utiliza una versiÃ³n de diferente de R

:::: {.columns}
::: {.column width="50%"}
[**rix:**](https://github.com/ropensci/rix)

- Utiliza Nix, un administrador de paquetes enfocado en compilaciones reproducibles. 

- Crea entornos especÃ­ficos del proyecto con una versiÃ³n personalizada de R, sus paquetes y todas las dependencias del sistema
:::

::: {.column width="50%"}
![](imagenes/rix.png){width=60% fig-align="center"}
:::
::::

-------------------------------------------------

## Problema: Necesito ayuda con el cÃ³digo

:::: {.columns}
::: {.column width="50%"}
El paquete `{reprex}` en R facilita la creaciÃ³n de un ejemplo reproducible. Puedes incluir la informaciÃ³n de la sesiÃ³n como por ejemplo versiones del paquete. 
:::

::: {.column width="50%"}
![](https://aosmith16.github.io/spring-r-topics/slides/figs/reprex.png){width=60% fig-align="center"}
:::
::::

-------------------------------------------------

## Problema: Necesito compartir el cÃ³digo con mis compaÃ±eros 

:::: {.columns}
::: {.column width="50%"}
![](https://cdn.prod.website-files.com/5f5a53e153805db840dae2db/64e79ca5aff2fb7295bfddf9_github-que-es.jpg){fig-align="center"}
:::

::: {.column width="50%"}
![](https://miro.medium.com/v2/resize:fit:600/1*p6exlg2Jrl3pimjPy7R-sA.png){width=60% fig-align="center"}
:::
::::

